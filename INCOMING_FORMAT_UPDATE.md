# Ενημέρωση Αναφοράς Email και PDF - Λεπτομέρειες Νέας Μορφής

## Περίληψη Αλλαγών

Έγιναν σημαντικές αλλαγές στη μορφή εμφάνισης των εισερχόμενων αιτήσεων (incoming requests) στο email και στο PDF αναφοράς. Αντί για απλούς πίνακες με περιορισμένες πληροφορίες, τώρα εμφανίζονται όλες οι λεπτομέρειες κάθε αίτησης σε μια ευανάγνωστη μορφή.

## Αλλαγές στο Email

### Νέα Δομή
Κάθε νέα αίτηση εμφανίζεται με το παρακάτω formated:

```
✅ Υπόθεση 911678(26234) - Αίτηση │ 2025-12-03 20:28
📋 Διαδικασία: ΥΓΕΙΑΣ-050 Άδεια ασκήσεως επαγγέλματος ψυχολόγου
🏢 Δ/νση: ΔΙΕΥΘΥΝΣΗ ΔΗΜΟΣΙΑΣ ΥΓΕΙΑΣ ΚΑΙ ΚΟΙΝΩΝΙΚΗΣ ΜΕΡΙΜΝΑΣ Μ.Ε. ΘΕΣΣΑΛΟΝΙΚΗΣ
👤 Συναλλασσόμενος: ΝΕΦΕΛΗ ΘΕΟΦΑΝΙΔΟΥ (Πολίτης)
```

### Εμφανιζόμενες Πληροφορίες
- ✅/🧪/🗑️ - Icon ανάλογα τον τύπο αίτησης (Πραγματική/Δοκιμαστική/Αφαιρέθηκε)
- **Υπόθεση ID(Protocol)** - Αριθμός υπόθεσης και αριθμός πρωτοκόλλου
- **Ημερομηνία και Ώρα** - Ημερομηνία υποβολής
- **Διαδικασία** - Πλήρης περιγραφή της διαδικασίας
- **Δ/νση** - Διεύθυνση που ενδιαφέρεται
- **Συναλλασσόμενος** - Όνομα του πολίτη/φορέα

### Τμήματα
Τρία ξεχωριστά τμήματα:
1. **🆕 Νέες ΠΡΑΓΜΑΤΙΚΕΣ αιτήσεις** - Πραγματικές αιτήσεις
2. **🧪 Νέες ΔΟΚΙΜΑΣΤΙΚΕΣ αιτήσεις** - Δοκιμαστικές αιτήσεις
3. **🗑️ Αφαιρέθηκαν αιτήσεις** - Αιτήσεις που αφαιρέθησαν

## Αλλαγές στο PDF

### Landscape Format
Το PDF δημιουργείται σε **landscape** προσανατολισμό για καλύτερη εμφάνιση των δεδομένων.

### Ίδια Δομή με Email
Το PDF χρησιμοποιεί την ίδια δομή με το email για συνέπεια.

### Κεφαλίδες και Διαχωρισμοί
- Κάθε τμήμα έχει σαφή κεφαλίδα
- Γραμμές διαχωρισμού για καλύτερη αναγνωσιμότητα
- Σύνοψη στο τέλος με τον συνολικό αριθμό νέων αιτήσεων

## Τεχνικές Λεπτομέρειες

### Αλλαγές σε `email_notifier.py`

#### 1. Νέα συνάρτηση `render_incoming_rows()`
```python
def render_incoming_rows(records, icon):
    # Αντί για πίνακα HTML, δημιουργεί divs με μορφοποιημένες πληροφορίες
    # Εμφανίζει: Case ID, Procedure, Directory, Party
```

#### 2. Ενημέρωση HTML Section
- Αντί για `<table>`, χρησιμοποιούνται `<div>` elements
- Κάθε αίτηση εμφανίζεται σε αναδυόμενο box με έγχρωμα σύνορα
- Σαφήςδιάκριση μεταξύ πραγματικών και δοκιμαστικών

#### 3. Ενημέρωση `generate_daily_report_pdf()`
- Landscape pagesize: `landscape(A4)`
- Πλήρες περιεχόμενο κάθε αίτησης σε formatted text
- Σύνοψη στο τέλος

## Παράδειγμα Εξόδου

### Email Section
```
🔁 Σύγκριση με snapshot 2025-12-02

🆕 Νέες ΠΡΑΓΜΑΤΙΚΕΣ αιτήσεις (1)
────────────────────────────────────────────────────────────────────────────────────────────────────

✅ Υπόθεση 911678(26234) - Αίτηση │ 2025-12-03 20:28
📋 Διαδικασία: ΥΓΕΙΑΣ-050 Άδεια ασκήσεως επαγγέλματος ψυχολόγου
🏢 Δ/νση: ΔΙΕΥΘΥΝΣΗ ΔΗΜΟΣΙΑΣ ΥΓΕΙΑΣ ΚΑΙ ΚΟΙΝΩΝΙΚΗΣ ΜΕΡΙΜΝΑΣ Μ.Ε. ΘΕΣΣΑΛΟΝΙΚΗΣ
👤 Συναλλασσόμενος: ΝΕΦΕΛΗ ΘΕΟΦΑΝΙΔΟΥ (Πολίτης)

🧪 Νέες ΔΟΚΙΜΑΣΤΙΚΕΣ αιτήσεις (3)
────────────────────────────────────────────────────────────────────────────────────────────────────

🧪 Υπόθεση 911257(2666) - Αίτηση │ 2025-12-03 13:55
📋 Διαδικασία: ΑΝΑΠ-74 Ανανέωση άδειας παραγωγού...
🏢 Δ/νση: ΔΙΕΥΘΥΝΣΗ ΑΝΑΠΤΥΞΗΣ ΚΑΙ ΠΕΡΙΒΑΛΛΟΝΤΟΣ Π.Ε. ΚΙΛΚΙΣ
👤 Συναλλασσόμενος: ΚΟΥΚΟΣ

...
```

## Δοκιμή

Για δοκιμή των αλλαγών:
```bash
python test_email_pdf.py
```

Αυτό θα:
1. Φορτώσει πραγματικά δεδομένα από το incoming_2025-12-03.json
2. Δημιουργήσει ένα δείγμα digest
3. Θα στείλει email (αν ενεργοποιημένο)
4. Θα δημιουργήσει PDF αναφορά

## Πολιτική Αντιστοίχησης

Οι αλλαγές είναι πλήρως συμβατές με τις υπάρχουσες συναρτήσεις και δεν αλλάζουν τη δομή των δεδομένων.
